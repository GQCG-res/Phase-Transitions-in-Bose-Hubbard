%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%This is the LaTeX ARTICLE template for RSC journals
%Copyright The Royal Society of Chemistry 2016
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[twoside,twocolumn,9pt]{article}

\usepackage{tgheros}
\renewcommand{\familydefault}{\sfdefault}

\usepackage{extsizes}
\usepackage[super,sort&compress,comma]{natbib} 
\usepackage[version=3]{mhchem}
\usepackage[left=1.5cm, right=1.5cm, top=1.785cm, bottom=2.0cm]{geometry}
\usepackage{balance}
\usepackage{mathptmx}
\usepackage{sectsty}
\usepackage{graphicx} 
\usepackage{lastpage}
\usepackage[format=plain,justification=justified,singlelinecheck=false,font={stretch=1.125,small,sf},labelfont=bf,labelsep=space]{caption}
\usepackage{float}
\usepackage{fancyhdr}
\usepackage{fnpos}
\usepackage[english]{babel}
\addto{\captionsenglish}{%
  \renewcommand{\refname}{Notes and references}
}
\usepackage{array}
\usepackage{droidsans}
\usepackage{charter}
\usepackage[T1]{fontenc}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{setspace}
\usepackage[compact]{titlesec}
\usepackage[utf8]{inputenc}
\usepackage{physics}
\usepackage{tikz}
\usepackage[mathscr]{euscript}  % \mathscr

%%%Please don't disable any packages in the preamble, as this may cause the template to display incorrectly.%%%


\usepackage{xcolor}
\definecolor{ugent_blue}{RGB}{30, 100, 200}
\definecolor{ugent_yellow}{cmyk}{.0, .10, 1, 0}

\usepackage{titlesec}
\titleformat{\section}
{\color{ugent_blue}\normalfont\Large\bfseries}
{\color{ugent_blue}\thesection}{1em}{}

\usepackage[colorlinks=true,linkcolor=black,citecolor=ugent_blue]{hyperref}
\usepackage{cleveref}

\usepackage{lineno}
\linenumbers

%\AtEveryCite{\color{ugent_blue}}




\usepackage{epstopdf}%This line makes .eps figures into .pdf - please comment out if not required.

\definecolor{cream}{RGB}{222,217,201}

\begin{document}

\pagestyle{fancy}
\thispagestyle{plain}
\fancypagestyle{plain}{
%%%HEADER%%%
\renewcommand{\headrulewidth}{0pt}
}
%%%END OF HEADER%%%

%%%PAGE SETUP - Please do not change any commands within this section%%%
\makeFNbottom
\makeatletter
\renewcommand\LARGE{\@setfontsize\LARGE{15pt}{17}}
\renewcommand\Large{\@setfontsize\Large{12pt}{14}}
\renewcommand\large{\@setfontsize\large{10pt}{12}}
\renewcommand\footnotesize{\@setfontsize\footnotesize{7pt}{10}}
\makeatother

\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\renewcommand\footnoterule{\vspace*{1pt}% 
\color{cream}\hrule width 3.5in height 0.4pt \color{black}\vspace*{5pt}} 
\setcounter{secnumdepth}{5}

\makeatletter 
\renewcommand\@biblabel[1]{#1}            
\renewcommand\@makefntext[1]% 
{\noindent\makebox[0pt][r]{\@thefnmark\,}#1}
\makeatother 
\renewcommand{\figurename}{\small{Fig.}~}
\sectionfont{\sffamily\Large}
\subsectionfont{\normalsize}
\subsubsectionfont{\bf}
\setstretch{1.125} %In particular, please do not alter this line.
\setlength{\skip\footins}{0.8cm}
\setlength{\footnotesep}{0.25cm}
\setlength{\jot}{10pt}
\titlespacing*{\section}{0pt}{4pt}{4pt}
\titlespacing*{\subsection}{0pt}{15pt}{1pt}
%%%END OF PAGE SETUP%%%

%%%FOOTER%%%
\fancyfoot{}
\fancyfoot[LO,RE]{\vspace{-7.1pt}\includegraphics[height=9pt]{head_foot/LF}}
\fancyfoot[CO]{\vspace{-7.1pt}\hspace{11.9cm}\includegraphics{head_foot/RF}}
\fancyfoot[CE]{\vspace{-7.2pt}\hspace{-13.2cm}\includegraphics{head_foot/RF}}
\fancyfoot[RO]{\footnotesize{\sffamily{1--\pageref{LastPage} {\color{ugent_yellow} ~\textbar } \hspace{2pt}\thepage}}}
\fancyfoot[LE]{\footnotesize{\sffamily{\thepage~{\color{ugent_yellow} ~\textbar }\hspace{4.65cm} 1--\pageref{LastPage}}}}
\fancyhead{}
\renewcommand{\headrulewidth}{0pt} 
\renewcommand{\footrulewidth}{0pt}
\setlength{\arrayrulewidth}{1pt}
\setlength{\columnsep}{6.5mm}
\setlength\bibsep{1pt}
%%%END OF FOOTER%%%

%%%FIGURE SETUP - please do not change any commands within this section%%%
\makeatletter 
\newlength{\figrulesep} 
\setlength{\figrulesep}{0.5\textfloatsep} 

\newcommand{\topfigrule}{\vspace*{-1pt}% 
\noindent{\color{cream}\rule[-\figrulesep]{\columnwidth}{1.5pt}} }

\newcommand{\botfigrule}{\vspace*{-2pt}% 
\noindent{\color{cream}\rule[\figrulesep]{\columnwidth}{1.5pt}} }

\newcommand{\dblfigrule}{\vspace*{-1pt}% 
\noindent{\color{cream}\rule[-\figrulesep]{\textwidth}{1.5pt}} }

\makeatother
%%%END OF FIGURE SETUP%%%

%%%TITLE, AUTHORS AND ABSTRACT%%%
\twocolumn[
  \begin{@twocolumnfalse}
{\includegraphics[height=30pt]{head_foot//RSC_LOGO_CMYK}\hfill\raisebox{0pt}[0pt][0pt]{\includegraphics[height=55pt]{head_foot/RSC_LOGO_CMYK}}\\[1ex]
\includegraphics[width=18.5cm]{head_foot/header_bar}}\par
\vspace{1em}
\sffamily
\begin{tabular}{m{4.5cm} p{13.5cm} }

& \noindent\LARGE{\textbf{Phase transitions in the Bose-Hubbard model$^\dag$}} \\%Article title goes here instead of the text "This is the title"
\vspace{0.3cm} & \vspace{0.3cm} \\

& \noindent\large{Xeno De Vriendt\textit{$^{a}$}, Robbe Brants\textit{$^{b}$}} \\%Author names go here instead of "Full name", etc.

& \\

& \noindent\normalsize{The Bose-Hubbard model is a theoretical model used for phenomenological descriptions of solid-state-physics and ultracold atoms in optical lattices. Its dynamics are able to uncover numerous phase transitions, most notably the Berezinskii-Kosterlitz-Thouless transition from the Mott-insulator phase to the superfluid phase. In this study, we propose to model this phase transition using both exact diagonalization as well as matrix product state ansatzes. By examining the properties of the different phases we aim to gain a deeper understanding of the complex behavior of these systems as well as their potential applications in several areas of physics. Our results will characterize the responses of these phases to external stresses and further uncover the underlying physics of such model systems.} \\%The abstrast goes here instead of the text "The abstract should be..."

\end{tabular}

\end{@twocolumnfalse} \vspace{1.6cm}

  ]
%%%END OF TITLE, AUTHORS AND ABSTRACT%%%

%%%FONT SETUP - please do not change any commands within this section
\renewcommand*\rmdefault{bch}\normalfont\upshape
\rmfamily
\section*{}
\vspace{-1cm}


% %%%FOOTNOTES%%%

\footnotetext{\textit{$^{a}$~Department of Chemistry, Ghent University, Krijgslaan 281 (S3), B-9000 Ghent, Belgium}}
\footnotetext{\textit{$^{b}$~Department of Physics and Astronomy, Ghent University, Krijgslaan 281 (S9), B-9000 Ghent, Belgium}}

% %Please use \dag to cite the ESI in the main text of the article.
% %If you article does not have ESI please remove the the \dag symbol from the title and the footnotetext below.
% \footnotetext{\dag~Electronic Supplementary Information (ESI) available: [details of any supplementary information available should be included here]. See DOI: 00.0000/00000000.}
% %additional addresses can be cited as above using the lower-case letters, c, d, e... If all authors are from the same address, no letter is required

% \footnotetext{\ddag~Additional footnotes to the title and authors can be included \textit{e.g.}\ `Present address:' or `These authors contributed equally to this work' as above using the symbols: \ddag, \textsection, and \P. Please place the appropriate symbol next to the author's name and include a \texttt{\textbackslash footnotetext} entry in the the correct place in the list.}


%%%END OF FOOTNOTES%%%

%%%MAIN TEXT%%%%


\section{Introduction}

The Bose-Hubbard model provides an excellent testbed to study quantum phase transitions (QPTs) \cite{sachdev1999} of strongly interacting bosonic systems in one \cite{kuhner1998} as well as higher dimensions \cite{freericks1994}. Due to the fundamental algebra underlying the physics of bosonic systems, the phase diagram of the bose-Hubbard model becomes more rich than that of its fermionic counterpart \cite{gu2004, deng2006, cozzini2007, chung2021, devriendt2022}. 

Of particular interest is the Mott-Hubbard transition \cite{mott1949}, which in the bosonic model encapsulates a quantum phase transition from a superfluid to a Mott-insulator (MI) \cite{elstner1999, capello2007, cucchietti2007}. In one dimension, this transition agrees with the Berezinskii-Kosterlitz-Thouless (BKT) \cite{kosterlitz1973} scenario of the interaction-driven Mott transition.

In this work we will aim to model several aspects of this phase transition. Using a combination of exact diagonalization \cite{zhang2010} and constrained wavefunction theory /cite{mukherji1963}. This allows us to show how intrinsic bosonic redistributions give rise to different phases in small one-dimensional lattices. 

However, for describing the phases of the total system, exact diagonalization methods fall short. Due to the exponential scaling of the number of configurations, the problem becomes too large to handle. The formalism of matrix product states (MPS) \cite{perez2006} circumvents this issue by decomposing the total wavefunction into a series of matrix products through subsequent singular value decompositions. In order to optimize such a MPS wavefunction, the density matrix renormalization group (DMRG) can be used. This allows us to model the complete phase diagram of the system and study its response to external factor like impurities. These results will, in combination with the results and limits of the exact diagonalization approach, further uncover the underlying physics of such model systems.

\section{Theory}
\subsection{The bose-Hubbard model}
The bose-Hubbard model Hamiltonian can be defined in an abstract site basis consisting of $L$ sites, allowing for inter-site hopping between nearest neighbors only, while introducing a site-dependent on-site repulsion that penalizes multiple occupation on a single site
\begin{equation}
  \hat{H} = \sum_{<i,j>} t_{ij}\hat{b}_i^\dagger \hat{b}_j + \frac{1}{2}\sum_i U_i\hat{b}_i^{\dagger 2} \hat{b}_i^{2} \thinspace ,
\end{equation}
where $t_{ij}$ is the hopping parameter which only affects nearest neighbors $<i,j>$, $U_i$ is the on-site energetic penalty and $\hat{b}^\dagger$ and $\hat{b}$ are the bosonic creation and annihilation operators respectively, which satisfy the bosonic commutation rules. Oftentimes a site-specific on-site potential is added to this model to allow for the introduction of asymmetry between the sites
\begin{equation}
  \hat{H} = \sum_{<i,j>} t_{ij}\hat{b}_i^\dagger \hat{b}_j + \frac{1}{2}\sum_i U_i\hat{b}_i^{\dagger 2} \hat{b}_i^{2} + \sum_i \omega_i \hat{b}_i^\dagger \hat{b}_i \thinspace .
  \label{eq:bose-hubbard-hamiltonian}
\end{equation}
Since the Hubbard Hamiltonian commutes with the total number operator $\hat{n}$
\begin{align}
  \hat{n}_i = \hat{b}_i^\dagger \hat{b}_i \thinspace &, \\
  \hat{n} = \sum_i \hat{n}_i \thinspace &, \\
  [\hat{H}, \hat{n}] = 0 \thinspace &,
\end{align}
the eigenstates of the Hamiltonian can be expanded in the orthonormal basis spanned by the eigenstates of the number operator
\begin{equation}
    \ket{\Psi}=\sum_{n_{1}\dots n_{L\alpha}} 
    \Psi^{n_{1} \ldots n_{L}}
    \ket{n_{1}\dots n_{L}} 
    \thinspace ,
    \label{theory:eigenstate}
\end{equation}
with $\Psi^{n_{1} \ldots n_{L}}$ the expansion coefficient belonging to a basis state $\ket{n_{1}\dots n_{L}}$ over $L$ sites.

\subsection{ground state properties of the Bose Hubbard model}
Single particle excitations in the groundstate of the Bose-Hubbard model can be defined as the difference between the potentials for half band filling and one particle less than half band filling
\begin{align}
  \mu^+(L) &= E_0(L, N+1) - E_0(L, N) \thinspace ,\\
  \mu^-(L) &= E_0(L, N) - E_0(L, N-1) \thinspace ,
\end{align}
with $E_0(X, Y)$ representing the groundstate energy of the system containing $X$ sites and $Y$ bosons. The excitation gap is then subsequently defined as their difference
\begin{equation}
  \Delta(L) = \mu^+(L) - \mu^-(L) \thinspace .
  \label{eq:gap}
\end{equation}

\subsection{Superfluid phase of the Bose-Hubbard model}
One of the phases of the Bose-Hubbard model can be described as a Luttinger Liquid. This is a generalization of the Fermi liquid for 1 dimension. It occurs at high values of t/U and is characterized by long interactions. The phase is gapless and the correlation function decays algebraically:
\begin{equation}
    \Gamma(r) = \langle b^\dagger(r)b(0)\rangle \sim r^{-K/2}
\end{equation}
For the Bose-Hubbard model it is dependent on $t/U$ and the filling of the sites. For a constant filling it is at first order given by 
\begin{equation}
    K = 1 - c \cdot \frac{U}{t}
\end{equation}
where c is some constant \cite{schulz1995fermi}. The phase transition to the superfluid phase occurs at a critical value
\begin{equation}
    K_c = \frac{n^2}{2}
\end{equation}
with n the integer site filling \cite{PhysRevB.46.9325}. \\
Because the density $\rho$ in this phase can be non-integer, density waves occur \cite{PhysRevLett.47.1840}. They can be caused by impurities or edge effects in a finite system. Generally the deviation from equilibrium is a superposition of an infinite amount of these waves, but the lowest order wave is given by 
\begin{equation}
    \langle n(r)n(0) \rangle_w \sim (\rho r)^{-2/K} \cos(2\pi\rho r)
\end{equation}
Although the correlation function decays faster for high values of K, the density waves decay slower instead. From the argument of the cosine, it is clear that these density waves do not occur for integer densities.

\subsection{Population redistributions on the bose-Hubbard model}
As shown in literature \cite{devriendt2021, devriendt2022}, we can redistribute particles within our system by imposing constraints through a Lagrangian formalism \cite{mukherji1963, zeiss1983, kaduk2011}
\begin{equation}
  \mathscr{L}(\vb{p}, \mu)
        = E_{tot}(\vb{p})
        - \mu ( m(\vb{p}) - M )
        \thinspace ,
\end{equation} 
where $m(\vb{p})$ is the value of the feature operator at the model parameters $\vb{p}$ and $M$ is the target value for the feature operator. The stationary condition of the Lagrange multiplier $\mu$ yields the value of the defined feature operator, and the stationary conditions of the model parameters $\vb{p}$ can be written as
\begin{equation}
  \eval{
    \pdv{
        \mathscr{L}(\vb{p}, \mu)
    }{p_i}
}_{\mu^\star, \thinspace \vb{p}^\star}
= \eval{
    \pdv{
        E_{tot}(\vb{p})
    }{p_i}
}_{\vb{p}^\star}
- \mu^\star \qty( 
    \eval{
        \pdv{
            m(\vb{p})
        }{p_i}
    }_{\vb{p}^\star}
)
= 0
\thinspace .
\label{eq:stationary_condition_model_parameters}
\end{equation}
Using these stationary conditions we can derive a modified Hamiltonian $\hat{H}_{mod}(\mu)$ where the feature operator $\hat{m}$ is weighed by the value of the Lagrange multiplier
\begin{equation}
  \hat{H}_{mod}(\mu) = \hat{H} - \mu \hat{m} \thinspace .
  \label{eq:modified-hamiltonian}
\end{equation}
It is important to note that, while the modified Hamiltonian is suited to optimize the model parameters of the wave function in such a way that the stationary condition of the Lagrange multiplier is satisfied, the energy of the system needs to be calculated using the original Hamiltonian of the system. This can be achieved by correcting for the imposed feature
\begin{align}
  \begin{split}
    E_{tot}(\vb{p}^\star)
    &= \ev*{\hat{H}}{\Psi(\vb{p}^\star)} \\ 
    &= \ev*{\hat{H}_{\text{mod}} + \mu\hat{m}}{\Psi(\vb{p}^\star)}
    \thinspace .
  \end{split}
\end{align}
In the context of the bose-Hubbard model, we will construct a feature operator with the goal of imposing bosonic redistributions on our model system. This can be done by arbitrarily dividing the total lattice into an \emph{open subsystem} $\Omega_{os}$ and an \emph{environment} $\omega_{env}$
\begin{equation}
  \Omega = (\Omega_{os}, \Omega_{env}) \thinspace ,
\end{equation} 
and subsequently defining the feature operator as the number operator of the open subsystem
\begin{equation}
  \hat{m} = \sum_i^{os}\hat{n}_i \thinspace .
  \label{eq:feature}
\end{equation}
Combining \cref{eq:modified-hamiltonian} with \cref{eq:bose-hubbard-hamiltonian} and \cref{eq:feature} yields
\begin{equation}
  \hat{H}_{mod}(\mu) = \sum_{<i,j>} t_{ij}\hat{b}_i^\dagger \hat{b}_j + \frac{1}{2}\sum_i U_i\hat{b}_i^{\dagger 2} \hat{b}_i^{2} + \sum_i \omega_i \hat{b}_i^\dagger \hat{b}_i - \sum_i^{os}\hat{n}_i \thinspace ,
\end{equation}
where the \emph{chemical potential} $\mu$ can be tuned in order to impose a certain redistribution of bosons between the open subsystem and the environment.

\subsection{Density matrix renormalization group}

In order to minimize an MPS wavefunction, we aim to minimize
\begin{equation}
  \min_\phi \bra{\psi - \phi}\ket{\psi - \phi} = \min_\phi [-2\bra{\phi}\ket{\psi} + \bra{\psi}\ket{\psi}] \thinspace ,
\end{equation}
where $\psi$ represents the original MPS, and $\phi$ the new MPS, compressed by truncating the singular values. In graphical representation, the norms on the right hand side become
\begin{equation} 
    \bra{\phi}\ket{\psi} =
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (0,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (1,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (2,0) {  };

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} \thinspace ,
\end{equation}
and
\begin{equation}
  \bra{\psi}\ket{\psi} = \\
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,0) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,0) {\tiny L};

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};    
  \end{tikzpicture} \thinspace ,
\end{equation}
where the red tensors represent the $\phi$ states and the gray tensors represent the $\psi$ states. This problem is solved by following the gradient until it reaches zero. If we take the derivative to, for example the elements of site two, the second site vanishes in the MPS representation
\begin{equation}\label{eq:gradient-1}
  \pderivative{\begin{tikzpicture}
    \draw[gray, thick] (0,0) -- (1,0);
    \draw[gray, thick] (0.5,0) -- (0.5,0.5);
    \node[draw, circle, line cap=round, fill=red!20] at (0.5,0) {\tiny 2};
  \end{tikzpicture}} \left[ \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (0,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (1,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (2,0) {  };

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} \right] = 
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-0.5);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (0.7,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (0,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (1,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (2,0) {  };

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} \thinspace .
\end{equation}
For the other term we get
\begin{equation}\label{eq:gradient-2}
  \pderivative{\begin{tikzpicture}
    \draw[gray, thick] (0,0) -- (1,0);
    \draw[gray, thick] (0.5,0) -- (0.5,0.5);
    \node[draw, circle, line cap=round, fill=red!20] at (0.5,0) {\tiny 2};
  \end{tikzpicture}} \left[ \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,0) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,0) {\tiny L};

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};    
  \end{tikzpicture} \right] = 2 \left[
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-0.5);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (0.7,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,0) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,0) {\tiny L};

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} \right] \thinspace .
\end{equation}
If we now consider 
\begin{equation}
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    \draw[gray, thick] (0,0) -- (1,0);
    \draw[gray, thick] (0.5,0) -- (0.5,0.5);
    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 2};
  \end{tikzpicture} = A^n_{ij} \equiv a[nij] 
\end{equation}
as a three-index tensor, we can combine \cref{eq:gradient-1} and \cref{eq:gradient-2} into $g[nij]$ and write the gradient step as
\begin{equation}\label{eq:a-tensor}
  a[nij] \rightarrow a[nij] + \epsilon g[nij] \thinspace .
\end{equation}
However, if we write the MPS in the mixed canonical form, i.e. absorb the singular values to the left, left of site two and to the right, right of site two, we can avoid the gradient algorithm all together. If we consider \cref{eq:a-tensor}, the \cref{eq:gradient-1} can also be written as a tensor
\begin{equation}\label{eq:gradient-1-as-tensor}
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-0.5);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (0.7,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (0,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (1,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (2,0) {  };

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} = b^T \thinspace .
\end{equation} 
In other words 
\begin{equation}
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (0,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (1,0) {  };
    \node[draw, circle, line cap=round, fill=black!20, minimum size=12] at (2,0) {  };

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} = b^T a \thinspace ,
\end{equation}
and
\begin{equation}
  \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,0) -- (1,-1);
    \draw[gray, thick] (2,0) -- (2,-1);
  
    \draw[gray, thick] (0,0) -- (1.3,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);
  
    \draw[gray, thick] (0,-1) -- (1.3,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);
  
    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,0) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,0) {\tiny L};
  
    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (1,-1) {\tiny 2};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};    
  \end{tikzpicture} = a^T M a \thinspace ,
\end{equation}
with
\begin{equation}
  M = \begin{tikzpicture}[baseline={([yshift=-.5ex]current bounding box.center)}]
    % Open system
    \draw[gray, thick] (0,0) -- (0,-1);
    \draw[gray, thick] (1,-0.25) -- (1,-0.75);
    \draw[gray, thick] (2,0) -- (2,-1);

    \draw[gray, thick] (0,0) -- (0.7,0);
    \draw[gray, dotted] (1.3,0) -- (1.7,0);
    \draw[gray, thick] (1.7,0) -- (2.0,0);

    \draw[gray, thick] (0,-1) -- (0.7,-1);
    \draw[gray, dotted] (1.3,-1) -- (1.7,-1);
    \draw[gray, thick] (1.7,-1) -- (2.0,-1);

    \node[draw, circle, line cap=round, fill=red!20] at (0,0) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (2,0) {\tiny L};

    \node[draw, circle, line cap=round, fill=red!20] at (0,-1) {\tiny 1};
    \node[draw, circle, line cap=round, fill=red!20] at (2,-1) {\tiny L};
  \end{tikzpicture} \thinspace .
\end{equation}
This turns the minimization problem into linear algebra
\begin{equation}
  \min_a(a^T M a - b^T a ) \rightarrow Ma = b \thinspace ,
\end{equation}
which can now be performed as a \emph{sweep algorithm} where the optimization is carried out site-by-site, and the updated tensors are used into every subsequent step. This optimization however boils down to 
\begin{equation}
  Ma = b \rightarrow a = b \thinspace ,
\end{equation}
since the mixed canonical form contains orthogonality in the left-gauged and right-gauged tensors respectively, thus simplifying the $a$ to a kronecker delta. 

\section{Methodology}

For the exact diagonalization (ED) calculations we look at a one-dimensional bose-Hubbard model of three sites, in the number sector where our system contains three bosons. The ED algorithm is self-implemented based on the algorithm described by Zhang and coworkers \cite{zhang2010}. $U/t$ is varied by gradually lowering the nearest neighbor hopping $t_{ij}$, evolving the system towards a more strongly correlated state. The formalism of constraints is either applied by scanning over a range of chemical potentials ($\mu_{os}$) or by optimizing the Lagrange multiplier in order to impose a certain population on the open subsystem ($N_{os}$). The latter is achieved by finding the root of the associated constraint $(\hat{n} - \expval{\hat{n}})$. When optimizing towards a certain population, a small asymmetry is introduced in the on-site potentials $\omega_i$, in order to facilitate the optimization procedure. For larger systems, the ITensors package \cite{Fishman2022} density matrix renormalization group (DMRG) algorithm was used.

\section{Results and discussion}
\subsection{Population redistributions show the effects of Mott-Hubbard type transitions}
The chemical potential $\mu_{os}$ induces changes in the open subsystem population $N_{os}$, which becomes increasingly stepwise as $U/t$ is increased, leading to the appearance of \emph{Mott-Hubbard plateaus} (\cref{fig:Mott-Hubbard}). The applied chemical potential determines when a given boson is exchanged between the open subsystem and its environment. While at low $U/t$-values, this process occurs continuously, the more strongly correlated the system becomes, the more discontinuous the exchange process becomes. 
\begin{center}
    \begin{figure}
        \includegraphics[width=\linewidth]{../code/figures/BH-3in3-NvsMu.pdf}
        \caption{Mott-Hubbard plateaus represented as the total open system population as a function of the applied chemical potential to the open subsystem for different values of $t_{ij}$.}
        \label{fig:Mott-Hubbard}
    \end{figure}
\end{center}
At high $U/t$, the Mott-plateaus restrict the movement of the bosons, indicating the system has transitioned to the MI-phase. The restriction of movement is also captured by the energy (\cref{fig:energetic-plateaus}), whose function becomes stepwise with energetic jumps occurring at the same critical $\mu_{os}$ where the boson-exchange takes place.
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/BH-3in3-EvsMu.pdf}
      \caption{Energetic Mott-Hubbard plateaus represented as a function of the applied chemical potential to the open subsystem for different values of $t_{ij}$.}
      \label{fig:energetic-plateaus}
  \end{figure}
\end{center}
The dual viewpoint which we can associate with these Mott-Hubbard plateaus is given by the energetic flat-planes \cite{perdew1982, cohen2008, cohen2012, yang2016}, where the total energy of the system ($E_{tot}$) becomes a series of straight line segments with discontinuities located at integer occupations (\cref{fig:flat-planes}). While previous results showed these characteristics for fermionic systems \cite{devriendt2021, devriendt2022}, we now show the same for the bosonic case.
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/BH-3in3-EvsN.pdf}
      \caption{Energetic flat-planes represented by $E_{tot}$ as a function of the population of the open subsystem ($N_{os}$) for different values of $t_{ij}$.}
      \label{fig:flat-planes}
  \end{figure}
\end{center}

\subsection{DMRG can model the complete groundstate Bose-Hubbard phase diagram}

At integer filling of the sites ($\rho=\frac{N}{L}$) the one-dimensional Bose-Hubbard model describes a Mott transition (\cref{fig:Mott-Lobes}) between a so-called superfluid phase which is defined by a divergence of the momentum distribution at momentum $k$ equal to zero, and an MI phase, characterized by a finite gap for single particle excitations, defined by the difference between the potentials for half band filling and one particle less than half band filling (\cref{eq:gap}).
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/Mott-Lobes.pdf}
      \caption{The first three Mott Lobes of the ground state Bose-Hubbard model. Colored sections represent the MI phases, while sections outside of the boundaries represent the superfluid phase. Calculated for $L=128$ using the DMRG algorithm.}
      \label{fig:Mott-Lobes}
  \end{figure}
\end{center}
At the critical point, i.e. the tip of each Mott lobe, the model resides in the universality class of the XY-spin model, which indicates the presence of a BKT phase transition.

Exact diagonalization was also used to model this behavior. Due to the limitations of the exponential scaling however, a small number of sites and particles was used. The first three Mott-Lobes for $L=6$ (\cref{fig:Mott-Lobes-ED}) are unable to describe a critical value $(t/U)_c$ where the gap $\Delta(L)$ closes.
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/Mott-Lobes-ED.pdf}
      \caption{The first three Mott Lobes of the ground state Bose-Hubbard model. Colored sections represent the MI phases, while sections outside of the boundaries represent the superfluid phase. Calculated for $L=6$ using ED.}
      \label{fig:Mott-Lobes-ED}
  \end{figure}
\end{center}
Due to large finite size effect, the small system is incapable of providing evidence of the critical point. 
\subsection{Density per site behaves distinctly different in the superfluid phase}

The bose-Hubbard model can be modified with the imposition of certain potentials on distinct sites of the lattice. Doing so adds impurities to the otherwise uniform lattice and can be used to study such impurities in solid state materials. Stabilizing impurities in the MI phase cause the bosonic population to increase on the affected sites, leading to compensation effects in the neighbouring sites (\cref{fig:density-MI}), as the total particle number is preserved.
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/Density-profiles-MI.pdf}
      \caption{Density profile of a chain in the Mott-insulator phase containing 129 sites ($L$) and two impurities (site 43 and 86), with a stabilizing potential.}
      \label{fig:density-MI}
  \end{figure}
\end{center}
As the strength of the impurity increases, the the amount of sites needed to compensate for the impurity increases. The MI phase attempts to preserve the average density $\rho=1.0$ a.u. on as much of the lattice as possible. The SF phase on the other hand has no energetic advantage in preserving the average density on each site. Indeed, in order to adjust the system occupations with respect to the impurity, the average density on all sites gets shifted (\cref{fig:density-SF})
\begin{center}
  \begin{figure}
      \includegraphics[width=\linewidth]{../code/figures/Density-profiles-SF.pdf}
      \caption{Density profile of a chain in the superfluid phase containing 129 sites ($L$) and two impurities (site 43 and 86), with a stabilizing potential.}
      \label{fig:density-SF}
  \end{figure}
\end{center}
The super-criticality in the particle number, associated with the SF phase, allows for the homogeneous compensation with respect to the impurities in the model.

\subsection{Density waves give indication of correlation length}

\section{Conclusions}

\begin{itemize}
  \item The bosonic Hubbard model shows identical characteristics to Fermi-Hubbard with the exception that multiple Mott-Hubbard plateaus arise, due to the absence of the fermionic occupation limit (i.e. Pauli's exclusion principle).
  \item The Bose Hubbard model also adheres to the flat-plane conditions as described by Perdew \cite{perdew1982}.
\end{itemize}

% \section*{Acknowledgements}

% \begin{itemize}
%   \item FWO, BOF 
%   \item HPC 
% \end{itemize}

%%%END OF MAIN TEXT%%%

%The \balance command can be used to balance the columns on the final page if desired. It should be placed anywhere within the first column of the last page.

\balance

%If notes are included in your references you can change the title from 'References' to 'Notes and references' using the following command:
%\renewcommand\refname{Notes and references}

%%%REFERENCES%%%
\bibliography{outline} %You need to replace "rsc" on this line with the name of your .bib file
\bibliographystyle{aip} %the AIP's .bst file

\end{document}
